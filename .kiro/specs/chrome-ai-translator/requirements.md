# 需求文档

## 简介

本功能涉及创建一个Chrome浏览器扩展，使用Chrome内置的Translator API提供AI驱动的翻译功能。该扩展将使用Vite + Vue 3构建，采用`<script setup>`语法，并具有类似Element Plus的自定义UI设计色调。扩展将利用Chrome的原生AI翻译能力，直接在浏览器中提供快速的离线翻译服务。

## 需求

### 需求 1

**用户故事：** 作为网页用户，我希望能够翻译网页上选中的文本，以便在不离开当前页面的情况下理解外语内容。

#### 验收标准

1. 当用户在网页上选择文本时，扩展应在选中文本附近显示翻译弹窗
2. 当用户点击翻译按钮时，系统应使用Chrome的Translator API翻译选中的文本
3. 当翻译完成时，系统应在弹窗中显示翻译文本，并清楚标示源语言和目标语言
4. 如果选中文本的语言不受支持，系统应显示适当的错误消息

### 需求 2

**用户故事：** 作为用户，我希望能够配置我偏好的源语言和目标语言，以便每次都能获得所需语言对的翻译，无需手动选择。

#### 验收标准

1. 当用户打开扩展弹窗时，系统应提供源语言和目标语言的下拉选择框
2. 当用户更改语言偏好时，系统应使用Chrome存储API将这些偏好保存到本地
3. 当用户执行后续翻译时，系统应使用保存的语言偏好作为默认设置
4. 如果Chrome的Translator API不支持某个语言对，系统应显示可用性状态并建议替代方案

### 需求 3

**用户故事：** 作为用户，我希望能够查看翻译历史，以便参考之前翻译过的内容。

#### 验收标准

1. 当翻译完成时，系统应将翻译对（源文本、翻译文本、语言）保存到本地存储
2. 当用户打开扩展弹窗时，系统应显示包含最近翻译的历史记录部分
3. 当用户点击历史记录项时，系统应显示完整的翻译详情
4. 当用户想要清除历史记录时，系统应提供带确认的清除历史记录选项
5. 当用户点击历史记录的详情按钮时，系统应显示详情弹窗，包含完整的原文和译文
6. 当显示详情弹窗时，系统应提供复制原文和复制译文的功能
7. 当使用缓存结果时，系统不应将该次翻译保存到历史记录中

### 需求 4

**用户故事：** 作为用户，我希望对较长文本进行实时流式翻译，以便能够看到翻译进度。

#### 验收标准

1. 当翻译超过100个字符的文本时，系统应使用流式翻译API
2. 当流式翻译激活时，系统应在部分结果可用时显示它们
3. 当流式翻译进行中时，系统应显示加载指示器
4. 如果流式翻译失败，系统应回退到常规翻译方法

### 需求 5

**用户故事：** 作为用户，我希望有一个简约朴素的界面，以便翻译体验感觉简洁高效。

#### 验收标准

1. 当显示扩展UI时，系统应使用简约的设计风格，避免过多装饰元素
2. 当显示扩展弹窗时，系统应设置固定宽度为420px，使用flex/grid布局优化排版
3. 当显示翻译结果时，系统应使用清晰的排版和适当的间距以提高可读性
4. 当用户与UI元素交互时，系统应提供简单的悬停状态，避免复杂动画

### 需求 6

**用户故事：** 作为用户，我希望扩展在可能的情况下能够离线工作，以便即使没有互联网连接也能翻译内容。

#### 验收标准

1. 当Chrome的Translator API可离线使用时，系统应使用离线功能
2. 当检查语言对可用性时，系统应验证在线和离线支持状态
3. 当离线翻译不可用时，系统应告知用户连接要求
4. 如果Translator API不可用，系统应显示适当的回退消息

### 需求 7

**用户故事：** 作为用户，我希望在短时间内重复翻译相同内容时能够快速获得结果，以便提高使用效率。

#### 验收标准

1. 当用户在同一会话中翻译相同的文本和语言对时，系统应避免重复调用Translator API
2. 当找到匹配的内存缓存结果时，系统应直接返回缓存的翻译结果
3. 当组件销毁时，系统应自动清理内存缓存

### 需求 8

**用户故事：** 作为开发者，我希望扩展使用现代开发实践构建，以便它易于维护并遵循Chrome扩展最佳实践。

#### 验收标准

1. 当构建扩展时，系统应使用Vite作为构建工具，并正确配置Chrome扩展
2. 当编写Vue组件时，系统应使用Vue 3 Composition API和`<script setup>`语法
3. 当实现Chrome扩展功能时，系统应使用Manifest V3规范
4. 当处理权限时，系统应仅请求翻译功能所需的必要权限